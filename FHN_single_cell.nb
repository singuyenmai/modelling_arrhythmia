(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     44615,       1038]
NotebookOptionsPosition[     43414,       1007]
NotebookOutlinePosition[     43806,       1023]
CellTagsIndexPosition[     43763,       1020]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["FitzHugh-Nagumo model for single cell", "Title",
 CellChangeTimes->{{3.842942328206706*^9, 3.842942349648015*^9}, {
   3.842942528953335*^9, 3.842942530487138*^9}, {3.842942610957922*^9, 
   3.8429426395297203`*^9}, {3.842942731365045*^9, 3.8429427958207197`*^9}, {
   3.842942848027944*^9, 3.842942861574478*^9}, {3.842942948716159*^9, 
   3.842943041069557*^9}, 3.8429431120864077`*^9, {3.8429431622482443`*^9, 
   3.842943202343111*^9}, {3.842943369888687*^9, 3.842943371310557*^9}, {
   3.84294361332917*^9, 3.8429436134522457`*^9}, 3.8429437457703323`*^9, {
   3.842943786763708*^9, 3.842943787046707*^9}, {3.842943954672974*^9, 
   3.8429439610484657`*^9}, {3.842944025406766*^9, 3.842944025546328*^9}, {
   3.8429441149191628`*^9, 3.842944211111497*^9}, {3.842944242185499*^9, 
   3.842944270210815*^9}, {3.8429443129040422`*^9, 3.842944396443818*^9}, {
   3.842944581233832*^9, 3.842944587514669*^9}, {3.842944638928504*^9, 
   3.842944640771428*^9}, {3.842947985031144*^9, 3.8429480153521013`*^9}, {
   3.8430190996809807`*^9, 3.843019114534772*^9}, {3.8431236489409*^9, 
   3.843123653141643*^9}},ExpressionUUID->"60091a76-509d-43e7-96e7-\
b2b41bc6b967"],

Cell[CellGroupData[{

Cell["Constant stimulation", "Subsubsection",
 CellChangeTimes->{{3.8430191732392197`*^9, 
  3.8430191796156797`*^9}},ExpressionUUID->"2b8a4bbe-5915-44a5-9e08-\
eca4fbe4458b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"constStimulation", "[", 
    RowBox[{
    "a_", ",", " ", "\[Gamma]_", ",", " ", "\[Epsilon]_", ",", " ", "Iext_", 
     ",", " ", "p_", ",", " ", "tmin_", ",", " ", "tmax_", ",", "minV_", ",", 
     " ", "maxV_", ",", " ", "minw_", ",", " ", "maxw_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "eqV", ",", " ", "eqw", ",", " ", "eql", ",", " ", "jacob", ",", " ", 
       "eig", ",", " ", "sys", ",", " ", "vars", ",", " ", "init", ",", " ", 
       "solution", ",", " ", "\[IndentingNewLine]", "timePlot", ",", " ", 
       "nullClines", ",", " ", "vectorField", ",", " ", "phasePlot", ",", " ",
        "eqlPlot", ",", " ", "aPlot", ",", " ", "graphs"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"eqV", "[", 
        RowBox[{"V_", ",", "w_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"1", "/", "\[Epsilon]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "w"}], " ", "+", " ", 
          RowBox[{"V", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "V"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"V", "-", "a"}], ")"}]}], " ", "+", " ", "Iext"}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eqw", "[", 
        RowBox[{"V_", ",", "w_"}], "]"}], ":=", 
       RowBox[{"V", "-", 
        RowBox[{"\[Gamma]", "*", "w"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eql", " ", "=", " ", 
       RowBox[{"NSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"eqV", "[", 
             RowBox[{"V", ",", " ", "w"}], "]"}], " ", "==", " ", "0.0"}], 
           ",", " ", 
           RowBox[{
            RowBox[{"eqw", "[", 
             RowBox[{"V", ",", " ", "w"}], "]"}], " ", "==", " ", "0.0"}]}], 
          "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"V", ",", " ", "w"}], "}"}], ",", " ", "Reals"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"jacob", " ", "=", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"eqV", "[", 
            RowBox[{"V", ",", " ", "w"}], "]"}], ",", " ", 
           RowBox[{"eqw", "[", 
            RowBox[{"V", ",", " ", "w"}], "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"V", ",", " ", "w"}], "}"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eig", " ", "=", " ", 
       RowBox[{"Eigenvalues", "[", 
        RowBox[{"jacob", "/.", 
         RowBox[{"eql", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"sys", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"V", "[", "t", "]"}], ",", " ", "t"}], "]"}], " ", "==", 
          " ", 
          RowBox[{"eqV", "[", 
           RowBox[{
            RowBox[{"V", "[", "t", "]"}], ",", " ", 
            RowBox[{"w", "[", "t", "]"}]}], "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"w", "[", "t", "]"}], ",", " ", "t"}], "]"}], " ", "==", 
          " ", 
          RowBox[{"eqw", "[", 
           RowBox[{
            RowBox[{"V", "[", "t", "]"}], ",", " ", 
            RowBox[{"w", "[", "t", "]"}]}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vars", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"V", "[", "t", "]"}], ",", " ", 
         RowBox[{"w", "[", "t", "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"init", " ", "=", " ", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"V", "[", "tmin", "]"}], ",", " ", 
           RowBox[{"w", "[", "tmin", "]"}]}], "}"}], " ", "==", " ", "p"}], 
        " ", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"solution", " ", "=", " ", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"sys", ",", " ", "init"}], "}"}], ",", " ", "vars", ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "tmin", ",", " ", "tmax"}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"timePlot", " ", "=", " ", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"vars", " ", "/.", " ", "solution"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "tmin", ",", " ", "tmax"}], "}"}], ",", " ", 
         
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tmin", ",", " ", "tmax"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"minV", ",", " ", "maxV"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"PlotStyle", " ", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Darker", "[", "Red", "]"}], ",", "Gray"}], "}"}]}], ",", 
         
         RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
         RowBox[{"FrameLabel", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<t\>\"", ",", " ", "\"\<V, w\>\""}], "}"}]}], ",", " ", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"draw", " ", "null", " ", "clines"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"nullClines", " ", "=", " ", 
       RowBox[{"ContourPlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"eqV", "[", 
             RowBox[{"V", ",", " ", "w"}], "]"}], "==", " ", "0"}], ",", " ", 
           
           RowBox[{
            RowBox[{"eqw", "[", 
             RowBox[{"V", ",", " ", "w"}], "]"}], "==", " ", "0"}]}], "}"}], 
         ",", " ", 
         RowBox[{"{", 
          RowBox[{"V", ",", " ", "minV", ",", " ", "maxV"}], "}"}], ",", " ", 
         
         RowBox[{"{", 
          RowBox[{"w", ",", " ", "minw", ",", " ", "maxw"}], "}"}], ",", 
         "\[IndentingNewLine]", " ", 
         RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
         RowBox[{"FrameLabel", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<V\>\"", ",", " ", "\"\<w\>\""}], "}"}]}], ",", " ", 
         RowBox[{"AspectRatio", " ", "->", " ", "1"}], ",", " ", 
         RowBox[{"ContourStyle", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{"Orange", ",", " ", 
            RowBox[{"Darker", "[", "Green", "]"}]}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"draw", " ", "vector", " ", "field"}], " ", "*)"}], "\n", 
      RowBox[{"vectorField", " ", "=", " ", 
       RowBox[{"VectorPlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"eqV", "[", 
            RowBox[{"V", ",", " ", "w"}], "]"}], ",", " ", 
           RowBox[{"eqw", "[", 
            RowBox[{"V", ",", " ", "w"}], "]"}]}], " ", "}"}], " ", ",", " ", 
         
         RowBox[{"{", 
          RowBox[{"V", ",", " ", "minV", ",", " ", "maxV"}], "}"}], ",", " ", 
         
         RowBox[{"{", 
          RowBox[{"w", ",", "minw", ",", " ", "maxw"}], "}"}], ",", " ", 
         RowBox[{"VectorStyle", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{"Gray", ",", "\"\<PinDart\>\""}], "}"}]}], ",", " ", 
         RowBox[{"VectorColorFunction", "\[Rule]", "None"}], ",", " ", 
         RowBox[{"VectorPoints", " ", "->", " ", "Fine"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phasePlot", " ", "=", " ", 
       RowBox[{"ParametricPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"vars", "/.", "solution"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "tmin", ",", " ", "tmax"}], "}"}], ",", " ", 
         
         RowBox[{"PlotStyle", "->", 
          RowBox[{"Darker", "[", "Blue", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"equilibrium", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"eqlPlot", " ", "=", " ", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"V", ",", " ", "w"}], "}"}], " ", "/.", " ", "eql"}], ",", 
         " ", 
         RowBox[{"PlotStyle", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"Black", ",", " ", 
             RowBox[{"PointSize", "[", "0.02", "]"}]}], "}"}], "}"}]}], ",", 
         " ", 
         RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
         RowBox[{"FrameLabel", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<V\>\"", ",", " ", "\"\<w\>\""}], "}"}]}], ",", " ", 
         RowBox[{"AspectRatio", " ", "->", " ", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "threshold", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"aPlot", " ", "=", " ", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", " ", "minw"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"a", ",", " ", "maxw"}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"graphs", " ", "=", " ", 
       RowBox[{"GraphicsRow", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", 
            RowBox[{
            "nullClines", ",", " ", "vectorField", ",", " ", "phasePlot", ",",
              " ", "eqlPlot", ",", " ", "aPlot"}], "]"}], ",", " ", 
           "\[IndentingNewLine]", "\t\t\t", "timePlot"}], "}"}], ",", " ", 
         RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<Real equilibrium at \>\"", ",", " ", "eql"}], "}"}], 
          "]"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{
          "\"\<with corresponding eigenvalues: \>\"", ",", " ", "eig"}], 
          "]"}], ",", "\[IndentingNewLine]", "graphs"}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"constStimulation", "[", 
    RowBox[{
    "a", ",", " ", "\[Gamma]", ",", " ", "\[Epsilon]", ",", " ", "Iext", ",", 
     " ", "p", ",", "tmin", ",", " ", "tmax", ",", " ", "Vmin", ",", " ", 
     "Vmax", ",", " ", "wmin", ",", "wmax"}], " ", "]"}], ",", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Model parameters\>\"", ",", "12"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "0.2", ",", "\"\<a\>\""}], "}"}], ",", "0.0", ",", 
     "1", ",", ".01", ",", 
     RowBox[{"Appearance", "\[Rule]", " ", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Gamma]", ",", "0.4", ",", "\"\<\[Gamma]\>\""}], "}"}], ",", 
     "0.0", ",", "1", ",", ".01", ",", 
     RowBox[{"Appearance", "\[Rule]", " ", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0.001", ",", "\"\<\[Epsilon]\>\""}], "}"}], 
     ",", "0.001", ",", "1", ",", ".01", ",", " ", 
     RowBox[{"Appearance", "\[Rule]", " ", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Iext", ",", "0.0", ",", 
       RowBox[{"Subscript", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<I\>\"", ",", "Italic"}], "]"}], ",", "\"\<stim\>\""}], 
        "]"}]}], "}"}], ",", "0.0", ",", "2", ",", ".01", ",", " ", 
     RowBox[{"Appearance", "\[Rule]", " ", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Initial conditions\>\"", ",", "12"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", 
       RowBox[{"{", 
        RowBox[{"0.0", ",", "0.0"}], "}"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<p\>\"", ",", "Italic"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   "Delimiter", ",", "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<t\>\"", ",", "Italic"}], "]"}], ",", "\"\<, \>\"", ",", 
        
        RowBox[{"Style", "[", 
         RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}], ",", "\"\< and \>\"", 
        ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<w\>\"", ",", "Italic"}], "]"}], ",", 
        "\"\< ranges\>\""}], "}"}], "]"}], ",", "12"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmin", ",", "0.0", ",", 
       RowBox[{"Subscript", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<t\>\"", ",", "Italic"}], "]"}], ",", "\"\<min\>\""}], 
        "]"}]}], "}"}], ",", "0", ",", "1000", ",", "1", ",", " ", 
     RowBox[{"Appearance", "\[Rule]", " ", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmax", ",", "1.0", ",", 
       RowBox[{"Subscript", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<t\>\"", ",", "Italic"}], "]"}], ",", "\"\<max\>\""}], 
        "]"}]}], "}"}], ",", "0", ",", "1000", ",", "1", ",", " ", 
     RowBox[{"Appearance", "\[Rule]", " ", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Vmin", ",", 
       RowBox[{"-", "0.5"}], ",", 
       RowBox[{"Subscript", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}], ",", "\"\<min\>\""}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1", ",", ".01", ",", " ", 
     RowBox[{"Appearance", "\[Rule]", " ", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Vmax", ",", "1.5", ",", 
       RowBox[{"Subscript", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}], ",", "\"\<max\>\""}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "3", ",", ".01", ",", " ", 
     RowBox[{"Appearance", "\[Rule]", " ", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"wmin", ",", 
       RowBox[{"-", "0.5"}], ",", 
       RowBox[{"Subscript", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<w\>\"", ",", "Italic"}], "]"}], ",", "\"\<min\>\""}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1", ",", ".01", ",", " ", 
     RowBox[{"Appearance", "\[Rule]", " ", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"wmax", ",", "1.5", ",", 
       RowBox[{"Subscript", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<w\>\"", ",", "Italic"}], "]"}], ",", "\"\<max\>\""}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "3", ",", ".01", ",", " ", 
     RowBox[{"Appearance", "\[Rule]", " ", "\"\<Labeled\>\""}]}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.842942328206706*^9, 3.842942349648015*^9}, {
   3.842942528953335*^9, 3.842942530487138*^9}, {3.842942610957922*^9, 
   3.8429426395297203`*^9}, {3.842942731365045*^9, 3.8429427958207197`*^9}, {
   3.842942848027944*^9, 3.842942861574478*^9}, {3.842942948716159*^9, 
   3.842943041069557*^9}, 3.8429431120864077`*^9, {3.8429431622482443`*^9, 
   3.842943202343111*^9}, {3.842943369888687*^9, 3.842943371310557*^9}, {
   3.84294361332917*^9, 3.8429436134522457`*^9}, 3.8429437457703323`*^9, {
   3.842943786763708*^9, 3.842943787046707*^9}, {3.842943954672974*^9, 
   3.8429439610484657`*^9}, {3.842944025406766*^9, 3.842944025546328*^9}, {
   3.8429441149191628`*^9, 3.842944211111497*^9}, {3.842944242185499*^9, 
   3.842944270210815*^9}, {3.8429443129040422`*^9, 3.842944396443818*^9}, {
   3.842944581233832*^9, 3.842944587514669*^9}, {3.842944638928504*^9, 
   3.842944640771428*^9}, {3.842947985031144*^9, 3.8429480153521013`*^9}, 
   3.8430190996809807`*^9, {3.843031993830688*^9, 3.843032024305311*^9}, {
   3.843032070774542*^9, 3.8430322006555033`*^9}, {3.8430322320614634`*^9, 
   3.843032233537356*^9}, {3.84303226582658*^9, 3.843032278394915*^9}, {
   3.8430323856986217`*^9, 3.843032457260653*^9}, {3.843032625966249*^9, 
   3.843032663963447*^9}, {3.843032710902075*^9, 3.843032721799985*^9}, {
   3.8430327794899807`*^9, 3.843033211246087*^9}, {3.8430333742135353`*^9, 
   3.843033480085246*^9}, {3.843033540175274*^9, 3.843033627880274*^9}, {
   3.84303368510236*^9, 3.843033695774808*^9}, {3.843033806525848*^9, 
   3.84303388041238*^9}, {3.8430340097836847`*^9, 3.843034013678898*^9}, {
   3.843034081401998*^9, 3.843034093174986*^9}, 3.843034137925124*^9, 
   3.843034184949785*^9, {3.8430343716898613`*^9, 3.843034385431487*^9}, {
   3.843034457635417*^9, 3.84303449606472*^9}, {3.843034682884736*^9, 
   3.8430347395272493`*^9}, {3.843034805589658*^9, 3.8430348060359297`*^9}, {
   3.843034861176133*^9, 3.843034930644404*^9}, {3.843034969963785*^9, 
   3.843034971067687*^9}, {3.843035006327466*^9, 3.843035132329571*^9}, {
   3.8430353784388313`*^9, 3.843035497453103*^9}, {3.843035534412109*^9, 
   3.8430357656420183`*^9}, {3.843035819459332*^9, 3.8430358550917673`*^9}, 
   3.843035938912126*^9, {3.843035987562849*^9, 3.8430360856076603`*^9}, {
   3.843036118822192*^9, 3.843036196380506*^9}, {3.843036531671516*^9, 
   3.84303657520897*^9}, 3.8430366156023493`*^9, {3.843036661831829*^9, 
   3.843036737216997*^9}, {3.843036815823535*^9, 3.843036858708352*^9}, {
   3.843036944368438*^9, 3.843037131065784*^9}, {3.8430372560634823`*^9, 
   3.843037291922974*^9}, {3.843037354446055*^9, 3.843037367776368*^9}, {
   3.843037400837284*^9, 3.8430374438069773`*^9}, {3.843037516572831*^9, 
   3.843037589245735*^9}, {3.843037641518502*^9, 3.843037671370366*^9}, {
   3.843037920990107*^9, 3.843038037820527*^9}, {3.843038337416782*^9, 
   3.843038384352758*^9}, {3.843038506226368*^9, 3.843038745741453*^9}, {
   3.843038832303095*^9, 3.843038836064232*^9}, {3.8430388788682213`*^9, 
   3.843038930446382*^9}, {3.8430391060252123`*^9, 3.84303911919318*^9}, {
   3.843108966786706*^9, 3.843108975800024*^9}, {3.843109010962325*^9, 
   3.843109064263411*^9}, {3.843109106254633*^9, 3.8431092656212893`*^9}, {
   3.843109305436079*^9, 3.8431094017747507`*^9}, 3.843109434546029*^9, {
   3.8431094664365396`*^9, 3.843109477855762*^9}, {3.843109596002234*^9, 
   3.843109642261256*^9}, {3.843109958047962*^9, 3.843110030970768*^9}, {
   3.8431100637524557`*^9, 3.843110085803652*^9}, {3.843110540048871*^9, 
   3.8431105441363487`*^9}, {3.843110600013399*^9, 3.843110602755101*^9}, {
   3.843114395122109*^9, 3.84311444148672*^9}, {3.84311550249189*^9, 
   3.843115502784816*^9}, 3.843123798764262*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"970b385c-b19a-4ff3-bedf-d6f263f33dd5"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = 0.2, $CellContext`Iext$$ = 
    0.1, $CellContext`p$$ = {0., 0.}, $CellContext`tmax$$ = 
    1., $CellContext`tmin$$ = 0., $CellContext`Vmax$$ = 
    1.5, $CellContext`Vmin$$ = -0.5, $CellContext`wmax$$ = 
    1.5, $CellContext`wmin$$ = -0.5, $CellContext`\[Gamma]$$ = 
    0.4, $CellContext`\[Epsilon]$$ = 0.001, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Style["Model parameters", 12]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`a$$], 0.2, "a"}, 0., 1, 0.01}, {{
       Hold[$CellContext`\[Gamma]$$], 0.4, "\[Gamma]"}, 0., 1, 0.01}, {{
       Hold[$CellContext`\[Epsilon]$$], 0.001, "\[Epsilon]"}, 0.001, 1, 
      0.01}, {{
       Hold[$CellContext`Iext$$], 0., 
       Subscript[
        Style["I", Italic], "stim"]}, 0., 2, 0.01}, {
      Hold[
       Style["Initial conditions", 12]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`p$$], {0., 0.}, 
       Style["p", Italic]}, {-1, -1}, {1, 1}}, {
      Hold[
       Style[
        Row[{
          Style["t", Italic], ", ", 
          Style["V", Italic], " and ", 
          Style["w", Italic], " ranges"}], 12]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`tmin$$], 0., 
       Subscript[
        Style["t", Italic], "min"]}, 0, 1000, 1}, {{
       Hold[$CellContext`tmax$$], 1., 
       Subscript[
        Style["t", Italic], "max"]}, 0, 1000, 1}, {{
       Hold[$CellContext`Vmin$$], -0.5, 
       Subscript[
        Style["V", Italic], "min"]}, -1, 1, 0.01}, {{
       Hold[$CellContext`Vmax$$], 1.5, 
       Subscript[
        Style["V", Italic], "max"]}, -1, 3, 0.01}, {{
       Hold[$CellContext`wmin$$], -0.5, 
       Subscript[
        Style["w", Italic], "min"]}, -1, 1, 0.01}, {{
       Hold[$CellContext`wmax$$], 1.5, 
       Subscript[
        Style["w", Italic], "max"]}, -1, 3, 0.01}}, Typeset`size$$ = {
    986., {217.8875, 223.5125}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = 0.2, $CellContext`Iext$$ = 
        0., $CellContext`p$$ = {0., 0.}, $CellContext`tmax$$ = 
        1., $CellContext`tmin$$ = 0., $CellContext`Vmax$$ = 
        1.5, $CellContext`Vmin$$ = -0.5, $CellContext`wmax$$ = 
        1.5, $CellContext`wmin$$ = -0.5, $CellContext`\[Gamma]$$ = 
        0.4, $CellContext`\[Epsilon]$$ = 0.001}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> $CellContext`constStimulation[$CellContext`a$$, $CellContext`\
\[Gamma]$$, $CellContext`\[Epsilon]$$, $CellContext`Iext$$, $CellContext`p$$, \
$CellContext`tmin$$, $CellContext`tmax$$, $CellContext`Vmin$$, \
$CellContext`Vmax$$, $CellContext`wmin$$, $CellContext`wmax$$], 
      "Specifications" :> {
        Style[
        "Model parameters", 12], {{$CellContext`a$$, 0.2, "a"}, 0., 1, 0.01, 
         Appearance -> 
         "Labeled"}, {{$CellContext`\[Gamma]$$, 0.4, "\[Gamma]"}, 0., 1, 0.01,
          Appearance -> 
         "Labeled"}, {{$CellContext`\[Epsilon]$$, 0.001, "\[Epsilon]"}, 0.001,
          1, 0.01, Appearance -> "Labeled"}, {{$CellContext`Iext$$, 0., 
          Subscript[
           Style["I", Italic], "stim"]}, 0., 2, 0.01, Appearance -> 
         "Labeled"}, Delimiter, 
        Style["Initial conditions", 12], {{$CellContext`p$$, {0., 0.}, 
          Style["p", Italic]}, {-1, -1}, {1, 1}}, Delimiter, 
        Style[
         Row[{
           Style["t", Italic], ", ", 
           Style["V", Italic], " and ", 
           Style["w", Italic], " ranges"}], 12], {{$CellContext`tmin$$, 0., 
          Subscript[
           Style["t", Italic], "min"]}, 0, 1000, 1, Appearance -> 
         "Labeled"}, {{$CellContext`tmax$$, 1., 
          Subscript[
           Style["t", Italic], "max"]}, 0, 1000, 1, Appearance -> 
         "Labeled"}, {{$CellContext`Vmin$$, -0.5, 
          Subscript[
           Style["V", Italic], "min"]}, -1, 1, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`Vmax$$, 1.5, 
          Subscript[
           Style["V", Italic], "max"]}, -1, 3, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`wmin$$, -0.5, 
          Subscript[
           Style["w", Italic], "min"]}, -1, 1, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`wmax$$, 1.5, 
          Subscript[
           Style["w", Italic], "max"]}, -1, 3, 0.01, Appearance -> 
         "Labeled"}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{1306., {304.6875, 310.3125}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8430388413728952`*^9, 3.843038860595523*^9}, {
   3.843038904363212*^9, 3.843038932770452*^9}, 3.843039140096451*^9, 
   3.843039172749605*^9, {3.843109486106119*^9, 3.843109509284217*^9}, {
   3.843109644299176*^9, 3.843109672881331*^9}, {3.843110088189427*^9, 
   3.843110113375471*^9}, {3.843110550711255*^9, 3.843110555657283*^9}, {
   3.8431106060053043`*^9, 3.843110616546432*^9}, 3.843113337406342*^9, 
   3.843114115733781*^9, {3.843114418620558*^9, 3.843114442586568*^9}, 
   3.84311533884562*^9, {3.843115504245461*^9, 3.843115515296856*^9}},
 CellLabel->"Out[8]=",ExpressionUUID->"8c93fecb-6012-4e4d-973a-cbe9f4a2c6a6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Periodic stimulation", "Subsubsection",
 CellChangeTimes->{{3.843019222208625*^9, 
  3.843019226189701*^9}},ExpressionUUID->"e5f69bf3-4f82-476e-8b0f-\
226021fbb6f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"periodicStimulation", "[", 
   RowBox[{
   "a_", ",", " ", "\[Gamma]_", ",", " ", "\[Epsilon]_", ",", " ", "tmin_", 
    ",", " ", "tmax_", ",", " ", "period_", ",", " ", "duration_", ",", " ", 
    "strength_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
     "eqV", ",", " ", "eqw", ",", " ", "stimuliTrain", ",", " ", "S", ",", 
      "sys", ",", " ", "vars", ",", " ", "init", ",", " ", "solution", ",", 
      "plotVw", ",", " ", "plotIext"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"eqV", "[", 
       RowBox[{"V_", ",", "w_", ",", "Iext_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"1", "/", "\[Epsilon]"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "w"}], " ", "+", " ", 
         RowBox[{"V", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "V"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"V", "-", "a"}], ")"}]}], " ", "+", " ", "Iext"}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eqw", "[", 
       RowBox[{"V_", ",", "w_"}], "]"}], ":=", 
      RowBox[{"V", "-", 
       RowBox[{"\[Gamma]", "*", "w"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"stimuliTrain", "[", 
       RowBox[{"t_", ",", " ", "A_", ",", "duty_", ",", " ", "T_"}], "]"}], ":=", 
      RowBox[{"A", "*", 
       RowBox[{"UnitBox", "[", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"t", "/", "T"}], ",", "1."}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"2.", " ", "duty"}], ")"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"stimuliTrain", "[", 
       RowBox[{
        RowBox[{"t", "-", 
         RowBox[{"(", 
          RowBox[{"duration", "+", 
           RowBox[{"1", "/", "2"}]}], ")"}]}], ",", " ", "strength", ",", " ",
         "duration", ",", " ", "period"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"sys", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"V", "[", "t", "]"}], ",", " ", "t"}], "]"}], " ", "==", 
         " ", 
         RowBox[{"eqV", "[", 
          RowBox[{
           RowBox[{"V", "[", "t", "]"}], ",", " ", 
           RowBox[{"w", "[", "t", "]"}], ",", "S"}], "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"w", "[", "t", "]"}], ",", " ", "t"}], "]"}], " ", "==", 
         " ", 
         RowBox[{"eqw", "[", 
          RowBox[{
           RowBox[{"V", "[", "t", "]"}], ",", " ", 
           RowBox[{"w", "[", "t", "]"}]}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vars", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"V", "[", "t", "]"}], ",", " ", 
        RowBox[{"w", "[", "t", "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"init", " ", "=", " ", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"V", "[", "0", "]"}], ",", " ", 
          RowBox[{"w", "[", "0", "]"}]}], "}"}], " ", "==", 
        RowBox[{"{", 
         RowBox[{"0.0", ",", " ", "0.0"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"solution", " ", "=", " ", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sys", ",", " ", "init"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"V", ",", "w"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"t", ",", "tmin", ",", " ", "tmax"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"plotVw", " ", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", "[", "t", "]"}], ",", 
            RowBox[{"w", "[", "t", "]"}]}], "}"}], "/.", "solution"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "tmin", ",", "tmax"}], "}"}], ",", " ", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Darker", "[", "Red", "]"}], ",", " ", "Gray"}], "}"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Frame", "->", "True"}], ",", " ", 
        RowBox[{"FrameLabel", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<t\>\"", ",", " ", "\"\<V, w\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"plotIext", " ", "=", " ", 
      RowBox[{"Plot", "[", 
       RowBox[{"S", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "tmin", ",", "tmax"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
        RowBox[{"ExclusionsStyle", "\[Rule]", 
         RowBox[{"Darker", "[", "Green", "]"}]}], ",", "\[IndentingNewLine]", 
        " ", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameLabel", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<t\>\"", ",", " ", "\"\<Stimulation\>\""}], "}"}]}], 
        ",", 
        RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"plotVw", ",", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"{", 
            RowBox[{"800", ",", "400"}], "}"}]}]}], "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"Show", "[", " ", 
         RowBox[{"plotIext", ",", " ", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"{", 
            RowBox[{"800", ",", "400"}], "}"}]}]}], "]"}]}], "}"}], "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQfeTm8TXXFr5xTGJ5vAdEG11efQlEX1FzuA6iX+wR
vg+i814ZfQLRdp2lP0H02h/3GK4D6W0FD+pBdMTar2A6zpKhBUSH20+eB6KV
zGsXgWiP38vAtIOv7HIQvXyvwWoQ7TalYzuILrtach1E37OacBtE61iuvQOi
XZaKvgTR6j+1X4PoKVvU/moteuOo8vufhDaQjlVX8AXRNn+0QkF0GvPcGBBd
0jY9FURfMOvPBdFsHqrFIPrWsQ01IDrJ6G4diH5x4+RGEP3YVPIgiK48m34c
RL/L/34CRPdfXn0NRMu/OPgQRM8JDtfVAdJhmplgWqnqpTWIniLwGUxf2XLG
DUSHfLkGplc1TA4C0S+e3gLTXO1WkSC6pvZ7NIgGAOso1ZY=
  "],
 CellLabel->"In[37]:=",ExpressionUUID->"19eca072-2d2f-4695-a971-a52279e7d2da"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"periodicStimulation", "[", 
    RowBox[{
    "a", ",", " ", "\[Gamma]", ",", " ", "\[Epsilon]", ",", " ", "tmin", ",", 
     " ", "tmax", ",", " ", "period", ",", "duration", ",", "strength"}], 
    "]"}], ",", " ", "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Model parameters\>\"", ",", "12"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "0.2", ",", "\"\<a\>\""}], "}"}], ",", "0.0", ",", 
     "1", ",", ".01", ",", 
     RowBox[{"Appearance", "\[Rule]", " ", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Gamma]", ",", "0.4", ",", "\"\<\[Gamma]\>\""}], "}"}], ",", 
     "0.0", ",", "1", ",", ".01", ",", 
     RowBox[{"Appearance", "\[Rule]", " ", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0.001", ",", "\"\<\[Epsilon]\>\""}], "}"}], 
     ",", "0.001", ",", "1", ",", ".01", ",", " ", 
     RowBox[{"Appearance", "\[Rule]", " ", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmin", ",", "0.0", ",", 
       RowBox[{"Subscript", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<t\>\"", ",", "Italic"}], "]"}], ",", "\"\<min\>\""}], 
        "]"}]}], "}"}], ",", "0", ",", "1000", ",", "1", ",", " ", 
     RowBox[{"Appearance", "\[Rule]", " ", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmax", ",", "5.0", ",", 
       RowBox[{"Subscript", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<t\>\"", ",", "Italic"}], "]"}], ",", "\"\<max\>\""}], 
        "]"}]}], "}"}], ",", "0", ",", "1000", ",", "1", ",", " ", 
     RowBox[{"Appearance", "\[Rule]", " ", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Stimulation\>\"", ",", "12"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"period", ",", "1", ",", "\"\<period\>\""}], "}"}], ",", "0", 
     ",", "10", ",", ".1", ",", " ", 
     RowBox[{"Appearance", "\[Rule]", " ", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"duration", ",", "0.01", ",", "\"\<duration\>\""}], "}"}], ",", 
     "0", ",", "1", ",", "0.01", ",", " ", 
     RowBox[{"Appearance", "\[Rule]", " ", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"strength", ",", "0.3", ",", "\"\<strength\>\""}], "}"}], ",", 
     "0", ",", "2", ",", "0.01", ",", " ", 
     RowBox[{"Appearance", "\[Rule]", " ", "\"\<Labeled\>\""}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8431086648697367`*^9, 3.8431087163023305`*^9}, {
   3.8431087489756956`*^9, 3.8431088791723003`*^9}, 3.8431091220240335`*^9, 
   3.843109229144806*^9, {3.8431108079292955`*^9, 3.8431108083511815`*^9}, {
   3.8431109353673067`*^9, 3.8431110440837526`*^9}, {3.84311251216005*^9, 
   3.843112512738395*^9}, 3.843113178616173*^9, {3.8431145197525516`*^9, 
   3.843114522353815*^9}, {3.8431149143834567`*^9, 3.843114924004426*^9}, {
   3.843115250191483*^9, 3.8431152507698464`*^9}, {3.843115783344263*^9, 
   3.8431157868902454`*^9}, 3.843116886284869*^9, {3.843116919755539*^9, 
   3.8431169268067503`*^9}, {3.843117576669807*^9, 3.843117693093114*^9}, {
   3.843117858063685*^9, 3.8431178773606873`*^9}, {3.843118642890566*^9, 
   3.84311864313278*^9}, 3.843118733260841*^9, 3.843121530735684*^9, {
   3.8431215645695333`*^9, 3.843121564744165*^9}, {3.843121616986636*^9, 
   3.8431216179518337`*^9}, {3.843122370591153*^9, 3.8431224160623703`*^9}, {
   3.843122504084538*^9, 3.843122519769711*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"1e38cdbe-24ec-40cf-9f1d-6d3744d1855f"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = 0.2, $CellContext`duration$$ = 
    0.01, $CellContext`period$$ = 0.27, $CellContext`strength$$ = 
    0.3, $CellContext`tmax$$ = 5., $CellContext`tmin$$ = 
    0., $CellContext`\[Gamma]$$ = 0.4, $CellContext`\[Epsilon]$$ = 0.001, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Style["Model parameters", 12]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`a$$], 0.2, "a"}, 0., 1, 0.01}, {{
       Hold[$CellContext`\[Gamma]$$], 0.4, "\[Gamma]"}, 0., 1, 0.01}, {{
       Hold[$CellContext`\[Epsilon]$$], 0.001, "\[Epsilon]"}, 0.001, 1, 
      0.01}, {{
       Hold[$CellContext`tmin$$], 0., 
       Subscript[
        Style["t", Italic], "min"]}, 0, 1000, 1}, {{
       Hold[$CellContext`tmax$$], 5., 
       Subscript[
        Style["t", Italic], "max"]}, 0, 1000, 1}, {
      Hold[
       Style["Stimulation", 12]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`period$$], 1, "period"}, 0, 10, 0.1}, {{
       Hold[$CellContext`duration$$], 0.01, "duration"}, 0, 1, 0.01}, {{
       Hold[$CellContext`strength$$], 0.3, "strength"}, 0, 2, 0.01}}, 
    Typeset`size$$ = {800., {399.78749999999997`, 405.41249999999997`}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = 0.2, $CellContext`duration$$ = 
        0.01, $CellContext`period$$ = 1, $CellContext`strength$$ = 
        0.3, $CellContext`tmax$$ = 5., $CellContext`tmin$$ = 
        0., $CellContext`\[Gamma]$$ = 0.4, $CellContext`\[Epsilon]$$ = 0.001},
       "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> $CellContext`periodicStimulation[$CellContext`a$$, \
$CellContext`\[Gamma]$$, $CellContext`\[Epsilon]$$, $CellContext`tmin$$, \
$CellContext`tmax$$, $CellContext`period$$, $CellContext`duration$$, \
$CellContext`strength$$], "Specifications" :> {
        Style[
        "Model parameters", 12], {{$CellContext`a$$, 0.2, "a"}, 0., 1, 0.01, 
         Appearance -> 
         "Labeled"}, {{$CellContext`\[Gamma]$$, 0.4, "\[Gamma]"}, 0., 1, 0.01,
          Appearance -> 
         "Labeled"}, {{$CellContext`\[Epsilon]$$, 0.001, "\[Epsilon]"}, 0.001,
          1, 0.01, Appearance -> "Labeled"}, 
        Delimiter, {{$CellContext`tmin$$, 0., 
          Subscript[
           Style["t", Italic], "min"]}, 0, 1000, 1, Appearance -> 
         "Labeled"}, {{$CellContext`tmax$$, 5., 
          Subscript[
           Style["t", Italic], "max"]}, 0, 1000, 1, Appearance -> "Labeled"}, 
        Delimiter, 
        Style[
        "Stimulation", 12], {{$CellContext`period$$, 1, "period"}, 0, 10, 0.1,
          Appearance -> 
         "Labeled"}, {{$CellContext`duration$$, 0.01, "duration"}, 0, 1, 0.01,
          Appearance -> 
         "Labeled"}, {{$CellContext`strength$$, 0.3, "strength"}, 0, 2, 0.01, 
         Appearance -> "Labeled"}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{1129., {430.6875, 436.3125}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.843119329348686*^9, 3.843120716932332*^9, 3.84312105902746*^9, 
   3.843121207366345*^9, {3.843121348187011*^9, 3.843121355168954*^9}, {
   3.843121520975068*^9, 3.84312164852185*^9}, 3.8431217223603897`*^9, {
   3.843121820364456*^9, 3.843121833057287*^9}, {3.843121910340605*^9, 
   3.843121928702566*^9}, 3.843122447526081*^9, {3.843122494981279*^9, 
   3.843122520510457*^9}, 3.8431226043183737`*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"feb48025-4827-4fe3-94d6-b999488d4fb0"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440., 765.75},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"12.3 for Linux x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"46259233-27e1-4c8a-a9ed-c5225e0fb2c1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1170, 16, 98, "Title",ExpressionUUID->"60091a76-509d-43e7-96e7-b2b41bc6b967"],
Cell[CellGroupData[{
Cell[1775, 42, 175, 3, 45, "Subsubsection",ExpressionUUID->"2b8a4bbe-5915-44a5-9e08-eca4fbe4458b"],
Cell[CellGroupData[{
Cell[1975, 49, 20032, 466, 1082, "Input",ExpressionUUID->"970b385c-b19a-4ff3-bedf-d6f263f33dd5"],
Cell[22010, 517, 6022, 124, 634, "Output",ExpressionUUID->"8c93fecb-6012-4e4d-973a-cbe9f4a2c6a6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28081, 647, 171, 3, 45, "Subsubsection",ExpressionUUID->"e5f69bf3-4f82-476e-8b0f-226021fbb6f4"],
Cell[28255, 652, 6505, 167, 422, "Input",ExpressionUUID->"19eca072-2d2f-4695-a971-a52279e7d2da"],
Cell[CellGroupData[{
Cell[34785, 823, 4199, 92, 278, "Input",ExpressionUUID->"1e38cdbe-24ec-40cf-9f1d-6d3744d1855f"],
Cell[38987, 917, 4387, 85, 886, "Output",ExpressionUUID->"feb48025-4827-4fe3-94d6-b999488d4fb0"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

